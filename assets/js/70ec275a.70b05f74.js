/*! For license information please see 70ec275a.70b05f74.js.LICENSE.txt */
"use strict";(self.webpackChunkhaltdos_wiki=self.webpackChunkhaltdos_wiki||[]).push([[70409],{10527:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>h,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"docs/waf/rules/header_rules","title":"Header Rules","description":"Overview","source":"@site/community/docs/waf/rules/header_rules.md","sourceDirName":"docs/waf/rules","slug":"/docs/waf/rules/header_rules","permalink":"/community/docs/waf/rules/header_rules","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"community_sidebar","previous":{"title":"Rules","permalink":"/community/docs/waf/rules/"},"next":{"title":"Firewall Rules","permalink":"/community/docs/waf/rules/firewall_rules"}}');var s=t(74848),r=t(28453);const a={sidebar_position:1},l="Header Rules",h={},d=[{value:"Overview",id:"overview",level:3},{value:"How to Use:",id:"how-to-use",level:3},{value:"Description",id:"description",level:3},{value:"Rule Name",id:"rule-name",level:4},{value:"Message",id:"message",level:4},{value:"Rule Priority",id:"rule-priority",level:4},{value:"HTTP URI",id:"http-uri",level:4},{value:"HTTP Method",id:"http-method",level:4},{value:"Rule Action",id:"rule-action",level:4},{value:"Evaluation Phase",id:"evaluation-phase",level:4},{value:"Attribute Name",id:"attribute-name",level:4},{value:"Attribute Value",id:"attribute-value",level:4},{value:"Parameter",id:"parameter",level:4},{value:"Add Condition",id:"add-condition",level:4},{value:"Condition Phase",id:"condition-phase",level:4},{value:"Find Location",id:"find-location",level:4},{value:"Parameter",id:"parameter-1",level:4},{value:"Match Condition",id:"match-condition",level:4},{value:"Match Value",id:"match-value",level:4}];function o(e){const i={h1:"h1",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"header-rules",children:"Header Rules"})}),"\n",(0,s.jsx)(i.h3,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(i.p,{children:"We have introduced Header rules by which application owners can manipulate request headers, cookies, and arguments in request as well as response headers. Users can create/update header rules at run time with on-the-fly updates. It has the functionality to add/remove/update any cookie/header/arguments in the request to the web-server(back-end) as well as respond to the client."}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"header rules",src:t(31924).A+"",width:"1658",height:"978"})}),"\n",(0,s.jsx)(i.h3,{id:"how-to-use",children:"How to Use:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Log onto the Haltdos Community WAF portal."}),"\n",(0,s.jsxs)(i.li,{children:["Go to ",(0,s.jsx)(i.strong,{children:"WAF"})," > ",(0,s.jsx)(i.strong,{children:"Rules"})," > ",(0,s.jsx)(i.strong,{children:"Header Rules"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Click on ",(0,s.jsx)(i.strong,{children:"Add Rule"})," and set relevant parameters described below."]}),"\n",(0,s.jsxs)(i.li,{children:["Click on ",(0,s.jsx)(i.strong,{children:"Save Changes"})]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"description",children:"Description"}),"\n",(0,s.jsx)(i.h4,{id:"rule-name",children:"Rule Name"}),"\n",(0,s.jsx)(i.p,{children:"Specify a rule name to identify the rule which is to be created. The rule name takes alpha-numeric input."}),"\n",(0,s.jsx)(i.h4,{id:"message",children:"Message"}),"\n",(0,s.jsx)(i.p,{children:"Specify a rule message containing a detailed description to identify the rule which is to be created."}),"\n",(0,s.jsx)(i.h4,{id:"rule-priority",children:"Rule Priority"}),"\n",(0,s.jsx)(i.p,{children:"User can define the rule's priority among various other custom error rules."}),"\n",(0,s.jsx)(i.h4,{id:"http-uri",children:"HTTP URI"}),"\n",(0,s.jsx)(i.p,{children:"Specify the URI or regex for which rule will be applied."}),"\n",(0,s.jsx)(i.h4,{id:"http-method",children:"HTTP Method"}),"\n",(0,s.jsx)(i.p,{children:"Select the HTTP method for the rule to validate when matched with the request."}),"\n",(0,s.jsx)(i.h4,{id:"rule-action",children:"Rule Action"}),"\n",(0,s.jsx)(i.p,{children:"The rule action determines what action (add/remove/overwrite) the rule will perform. The accepted values are:"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"ADD:"})," This condition will allow adding a value at the specified location."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"REMOVE:"})," This condition will allow removing a value at the specified location."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"OVERWRITE:"})," This condition will allow overwriting a value at the specified location."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["If the action is ",(0,s.jsx)(i.strong,{children:"ADD"})," then another field is required I.e., ",(0,s.jsx)(i.strong,{children:"Value"})," that will be added for the specified ",(0,s.jsx)(i.strong,{children:"Parameter"}),"."]}),"\n",(0,s.jsxs)(i.p,{children:["If the action is ",(0,s.jsx)(i.strong,{children:"REMOVE"}),", then the specified parameter is removed."]}),"\n",(0,s.jsxs)(i.p,{children:["If the action is ",(0,s.jsx)(i.strong,{children:"OVERWRITE"}),", then two other fields are required first is ",(0,s.jsx)(i.strong,{children:"Search Pattern"})," (string/regex that should match the existing value) and ",(0,s.jsx)(i.strong,{children:"Replace"})," (the string that should be overwritten). We can capture string from the PCRE capturing group using position with a prefix of '$'."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Note:"})," In order to escape the dollar($) character in the replace, add the dollar symbol twice."]}),"\n",(0,s.jsx)(i.h4,{id:"evaluation-phase",children:"Evaluation Phase"}),"\n",(0,s.jsx)(i.p,{children:"Select the evaluation phase for the rule i.e. Request or Response."}),"\n",(0,s.jsx)(i.h4,{id:"attribute-name",children:"Attribute Name"}),"\n",(0,s.jsx)(i.p,{children:"Specify the attribute name which need to add/delete/overwrite with rule."}),"\n",(0,s.jsx)(i.h4,{id:"attribute-value",children:"Attribute Value"}),"\n",(0,s.jsx)(i.p,{children:"Specify the attribute value which will be mentioned in the attribute."}),"\n",(0,s.jsx)(i.h4,{id:"parameter",children:"Parameter"}),"\n",(0,s.jsx)(i.p,{children:"This field specifies the name of the header/cookie/ arguments on which action will be performed."}),"\n",(0,s.jsx)(i.h4,{id:"add-condition",children:"Add Condition"}),"\n",(0,s.jsx)(i.p,{children:"The user can specify some request/response-based conditions which can be used as mandatory conditions to be fulfilled to apply the rule."}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"header rules",src:t(64680).A+"",width:"930",height:"401"})}),"\n",(0,s.jsx)(i.p,{children:"For adding a condition, the required fields are:"}),"\n",(0,s.jsx)(i.h4,{id:"condition-phase",children:"Condition Phase"}),"\n",(0,s.jsx)(i.p,{children:"This field determines that the condition will be checked on request/response parameters."}),"\n",(0,s.jsx)(i.h4,{id:"find-location",children:"Find Location"}),"\n",(0,s.jsx)(i.p,{children:"This field determines whether the condition should be checked on headers/cookies/arguments. The accepted values are:"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"URL:"})," Select this if the specified value has to be searched in the URL part of the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"HTTP Scheme:"})," Select this if the specified value has to be searched in the"]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Country:"})," Select if specified value has to be search as source country."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Header Name:"})," Select this if the specified name has to be searched in the Headers part of the HTTP Header variables."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Header Value:"})," Select this if the specified value has to be searched in the Headers part of the HTTP Header values."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Headers:"})," Select this if the specified value has to be searched in the Headers part of the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Cookie Name:"})," Select this if the specified name has to be searched in the Headers part of the HTTP Header cookie variables."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Cookie Value:"})," Select this if the specified value has to be searched in the Headers part of the HTTP Header cookie values."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Cookies:"})," Select this if the specified value has to be searched in the Headers part of the HTTP Header cookies."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Body Argument Name:"})," Select this if the specified name has to be searched in the variables in the Body part of the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Body Argument Value:"})," Select this if the specified value has to be searched in the values in the Body part of the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Body:"})," Select this if the specified value has to be searched in the Body part of the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Argument Name:"})," Select this if the specified name has to be searched in the variables in the Arguments section in the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Argument Value:"})," Select this if the specified value has to be searched in the variables in the Arguments section in the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Arguments:"}),"  Select this if the specified value has to be searched in the Arguments section in the HTTP Header."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Variable:"})," Users can select the specific variable that has to be find."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"SRC IP:"}),"  Select if specified value has to be search as source IP."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Client Browser:"})," Select if specified value has to be search as client browser."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Client OS:"})," Select if specified value has to be search as client OS."]}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Client Device:"}),"  Select if specified value has to be search as client device."]}),"\n",(0,s.jsx)(i.h4,{id:"parameter-1",children:"Parameter"}),"\n",(0,s.jsx)(i.p,{children:"This field specifies the name of the header/cookie/ arguments on which condition will be validated. Search Pattern: This field specifies the pattern that will be matched against the header/cookie/ argument value to satisfy the condition."}),"\n",(0,s.jsx)(i.h4,{id:"match-condition",children:"Match Condition"}),"\n",(0,s.jsx)(i.p,{children:"The user can define the match condition for the parameter and match value."}),"\n",(0,s.jsx)(i.h4,{id:"match-value",children:"Match Value"}),"\n",(0,s.jsx)(i.p,{children:"The user can define what value needs to be matched with the match condition."})]})}function c(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},21020:(e,i,t)=>{var n=t(96540),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function d(e,i,t){var n,r={},d=null,o=null;for(n in void 0!==t&&(d=""+t),void 0!==i.key&&(d=""+i.key),void 0!==i.ref&&(o=i.ref),i)a.call(i,n)&&!h.hasOwnProperty(n)&&(r[n]=i[n]);if(e&&e.defaultProps)for(n in i=e.defaultProps)void 0===r[n]&&(r[n]=i[n]);return{$$typeof:s,type:e,key:d,ref:o,props:r,_owner:l.current}}i.Fragment=r,i.jsx=d,i.jsxs=d},28453:(e,i,t)=>{t.d(i,{R:()=>a,x:()=>l});var n=t(96540);const s={},r=n.createContext(s);function a(e){const i=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(r.Provider,{value:i},e.children)}},31924:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/header_rules-a297f220e494569f889ccd381c5ebcf4.png"},64680:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/headerrulescondition-f21c38af1f66abe1bb89e0d6a6a0d059.png"},74848:(e,i,t)=>{e.exports=t(21020)}}]);