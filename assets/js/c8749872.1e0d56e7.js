/*! For license information please see c8749872.1e0d56e7.js.LICENSE.txt */
"use strict";(self.webpackChunkhaltdos_wiki=self.webpackChunkhaltdos_wiki||[]).push([[21531],{9946:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"cloud/waf/listener/profiles/rules/script_rules","title":"Script Rule","description":"Overview","source":"@site/docs/cloud/waf/listener/profiles/rules/script_rules.md","sourceDirName":"cloud/waf/listener/profiles/rules","slug":"/cloud/waf/listener/profiles/rules/script_rules","permalink":"/cloud/waf/listener/profiles/rules/script_rules","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11},"sidebar":"cloud_sidebar","previous":{"title":"Deception Rules","permalink":"/cloud/waf/listener/profiles/rules/deception_rules"},"next":{"title":"Log Rules","permalink":"/cloud/waf/listener/profiles/rules/log_rules"}}');var s=i(74848),n=i(28453);const l={sidebar_position:11},o="Script Rule",c={},a=[{value:"Overview",id:"overview",level:3},{value:"How to Use:",id:"how-to-use",level:3},{value:"Description",id:"description",level:3},{value:"<strong>Rule Name</strong>",id:"rule-name",level:5},{value:"<strong>Rule Message</strong>",id:"rule-message",level:5},{value:"<strong>Rule Priority</strong>",id:"rule-priority",level:5},{value:"<strong>Add Condition</strong>",id:"add-condition",level:5}];function d(e){const r={a:"a",br:"br",code:"code",h1:"h1",h3:"h3",h5:"h5",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"script-rule",children:"Script Rule"})}),"\n",(0,s.jsx)(r.h3,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(r.p,{children:"Developer Script strategies will be implemented as a developer script rule. This rule is capable of customizing a script to interpret or managing specific requests. The goal of the developer script is to deceive and manipulate the request on the basis of certain parameters inducing them to take actions that result in blocking the requests coming from them."}),"\n",(0,s.jsx)(r.p,{children:"For the given URI, the developer script will be executed and if the condition matches the rule the appropriate action will be taken as per the rule. User can define their own logic which may not be present in the WAF rules and thus could mitigate the specific attack."}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{alt:"Script Rule",src:i(29708).A+"",width:"1910",height:"900"})}),"\n",(0,s.jsx)(r.p,{children:"The developer script defines two phases:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Request Phase"}),": This developer script is executed before sending the request to web-servers."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Response Phase"}),": This developer script is executed after getting the response from the web servers and before reaching the web client."]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"The script for this rule is written in Lua scripting language. In this, we define the Lua script which will be executed for the required phase. In order to perform the action, the script must return 1 (Numeric) as a value. We also provide some utility methods such as MD5, Base64 encoding, and much more. We can access the Nginx variable too."}),"\n",(0,s.jsxs)(r.p,{children:["If somehow the script faces a compilation error, the script will fail to perform an action and the request will be processed.",(0,s.jsx)(r.br,{}),"\n","The behavior of the script may vary for the following configurations:"]}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"If the Temporary Blacklist value is set to 0, then the script will be ignored."}),"\n",(0,s.jsx)(r.li,{children:"If the action is set to No Action, then the script will be ignored."}),"\n",(0,s.jsx)(r.li,{children:"If multiple scripts are matched for the request URI, then the first matched script will be executed and other scripts will be ignored."}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"how-to-use",children:"How to Use:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["Go to ",(0,s.jsx)(r.strong,{children:"WAF"})," > ",(0,s.jsx)(r.strong,{children:"Listeners"})," > ",(0,s.jsx)(r.strong,{children:"Profiles"})," > ",(0,s.jsx)(r.strong,{children:"Rules"})," > ",(0,s.jsx)(r.strong,{children:"Developer Script Rules"})]}),"\n",(0,s.jsx)(r.li,{children:"Click on Add Rule and set relevant parameters."}),"\n",(0,s.jsxs)(r.li,{children:["Click on ",(0,s.jsx)(r.strong,{children:"Save Changes"}),"."]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"description",children:"Description"}),"\n",(0,s.jsx)(r.h5,{id:"rule-name",children:(0,s.jsx)(r.strong,{children:"Rule Name"})}),"\n",(0,s.jsx)(r.p,{children:"Users are allowed to specify the rule name to identify the rule which is to be created. The rule name takes alpha-numeric input."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"    Accepted values: String\n\n    Default: Blank\n"})}),"\n",(0,s.jsx)(r.h5,{id:"rule-message",children:(0,s.jsx)(r.strong,{children:"Rule Message"})}),"\n",(0,s.jsx)(r.p,{children:"Users are allowed to specify a rule message containing a detailed description to identify the rule which is to be created."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"    Accepted values: Description for the rule in String format\n\n    Default: Blank  \n"})}),"\n",(0,s.jsx)(r.h5,{id:"rule-priority",children:(0,s.jsx)(r.strong,{children:"Rule Priority"})}),"\n",(0,s.jsx)(r.p,{children:"It is a numeric field that specifies the priority of the rule in which the rule will be executed while evaluating the request. The lower value of priority means it will be executed first while executing the type of rule. The default value Is 0."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"    Accepted values: Integer\n\n    Default: 0\n"})}),"\n",(0,s.jsx)(r.h5,{id:"add-condition",children:(0,s.jsx)(r.strong,{children:"Add Condition"})}),"\n",(0,s.jsx)(r.p,{children:"The user can specify some request/response-based conditions which can be used as mandatory conditions to be fulfilled to apply the rule."}),"\n",(0,s.jsxs)(r.p,{children:["To configure the parameter of the conditions please refer to the following link: ",(0,s.jsx)(r.a,{href:"/cloud/waf/listener/profiles/rules/ruleCond",children:(0,s.jsx)(r.strong,{children:"Conditions"})})]})]})}function h(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},21020:(e,r,i)=>{var t=i(96540),s=Symbol.for("react.element"),n=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(e,r,i){var t,n={},a=null,d=null;for(t in void 0!==i&&(a=""+i),void 0!==r.key&&(a=""+r.key),void 0!==r.ref&&(d=r.ref),r)l.call(r,t)&&!c.hasOwnProperty(t)&&(n[t]=r[t]);if(e&&e.defaultProps)for(t in r=e.defaultProps)void 0===n[t]&&(n[t]=r[t]);return{$$typeof:s,type:e,key:a,ref:d,props:n,_owner:o.current}}r.Fragment=n,r.jsx=a,r.jsxs=a},28453:(e,r,i)=>{i.d(r,{R:()=>l,x:()=>o});var t=i(96540);const s={},n=t.createContext(s);function l(e){const r=t.useContext(n);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(n.Provider,{value:r},e.children)}},29708:(e,r,i)=>{i.d(r,{A:()=>t});const t=i.p+"assets/images/scriptRules-ed5214a842683af8e5d89d19bbc415f8.png"},74848:(e,r,i)=>{e.exports=i(21020)}}]);